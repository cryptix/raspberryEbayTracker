<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<title>Charting Raspberry Pi bidding</title>
		<style type="text/css" media="screen">
		li {
			float: left;
		}
		.bidPlot {
			width: 600px; height: 300px;
		}
		</style>
		<script src="http://code.jquery.com/jquery-1.6.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="http://flot.googlecode.com/svn/trunk/jquery.flot.js" type="text/javascript" charset="utf-8"></script>
		<script src="https://raw.github.com/timrwood/moment/1.2.0/moment.min.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" charset="utf-8">
			$(function() {
				var plotOpts = {
			        lines: { show: true },
			        points: { show: true },
			        xaxis: { tickDecimals: 0, tickSize: 1 }
			    };
				
				function plotData(data) {
					$.plot($('#combined > .bidPlot'), data, plotOpts);
					Object.keys(data).forEach(function(id) {
						$.plot($('#' + data[id].label + ' > .bidPlot'), [data[id]], plotOpts);
					});
				}
				
				function pullData() {
		        	$.ajax({
		            	url: '/bids',
		            	method: 'GET',
		            	dataType: 'json',
		        		success: plotData
		        	});
				}
				
				setInterval(pullData,1000*15);
				$('#update').click(pullData);
	        	pullData();
				
			});
		</script>
		
	</head>
	<body onload="">
		<h1 id="rapsberry_pi_bidding">Rapsberry Pi Bidding</h1>
		<button id='update'>Update Data</button>
		<ol id="bids">
			<li id="combined">
				<h2>Combined</h2>
				<div class="bidPlot"></div>
			</li>
			<li id="180786734741"><h2>180786734741</h2><div class="bidPlot"></div></li>
			<li id="180786751081"><h2>180786751081</h2><div class="bidPlot"></div></li>
			<li id="180786864217"><h2>180786864217</h2><div class="bidPlot"></div></li>
			<li id="180786865158"><h2>180786865158</h2><div class="bidPlot"></div></li>
			<li id="180786865908"><h2>180786865908</h2><div class="bidPlot"></div></li>
			<li id="180786866596"><h2>180786866596</h2><div class="bidPlot"></div></li>
			<li id="180786867221"><h2>180786867221</h2><div class="bidPlot"></div></li>
			<li id="180786868894"><h2>180786868894</h2><div class="bidPlot"></div></li>
			<li id="180786868461"><h2>180786868461</h2><div class="bidPlot"></div></li>
			<li id="180786867900"><h2>180786867900</h2><div class="bidPlot"></div></li>
			</ol>
	</body>
</html>